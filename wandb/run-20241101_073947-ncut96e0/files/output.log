  0%|                                                                                                                                                                                                   | 0/390 [00:00<?, ?it/s]2024-11-01 07:39:58,499 - ERROR - Training failed: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasSgemm( handle, opa, opb, m, n, k, &alpha, a, lda, b, ldb, &beta, c, ldc)`
Traceback (most recent call last):
  File "/home/thiendc/projects/legal_retrieval/batch_train_v2.py", line 187, in <module>
    main()
  File "/home/thiendc/projects/legal_retrieval/batch_train_v2.py", line 179, in main
    trainer.train()
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/transformers/trainer.py", line 2052, in train
    return inner_training_loop(
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/transformers/trainer.py", line 2388, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/transformers/trainer.py", line 3485, in training_step
    loss = self.compute_loss(model, inputs)
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/sentence_transformers/trainer.py", line 348, in compute_loss
    loss = loss_fn(features, labels)
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/sentence_transformers/losses/MatryoshkaLoss.py", line 152, in forward
    loss += weight * self.loss(sentence_features, labels)
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/sentence_transformers/losses/MultipleNegativesRankingLoss.py", line 105, in forward
    scores = self.similarity_fct(embeddings_a, embeddings_b) * self.scale
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/sentence_transformers/util.py", line 108, in cos_sim
    return torch.mm(a_norm, b_norm.transpose(0, 1))
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasSgemm( handle, opa, opb, m, n, k, &alpha, a, lda, b, ldb, &beta, c, ldc)`
Traceback (most recent call last):
  File "/home/thiendc/projects/legal_retrieval/batch_train_v2.py", line 187, in <module>
    main()
  File "/home/thiendc/projects/legal_retrieval/batch_train_v2.py", line 179, in main
    trainer.train()
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/transformers/trainer.py", line 2052, in train
    return inner_training_loop(
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/transformers/trainer.py", line 2388, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/transformers/trainer.py", line 3485, in training_step
    loss = self.compute_loss(model, inputs)
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/sentence_transformers/trainer.py", line 348, in compute_loss
    loss = loss_fn(features, labels)
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/sentence_transformers/losses/MatryoshkaLoss.py", line 152, in forward
    loss += weight * self.loss(sentence_features, labels)
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/sentence_transformers/losses/MultipleNegativesRankingLoss.py", line 105, in forward
    scores = self.similarity_fct(embeddings_a, embeddings_b) * self.scale
  File "/home/thiendc/projects/.thienenv/lib/python3.10/site-packages/sentence_transformers/util.py", line 108, in cos_sim
    return torch.mm(a_norm, b_norm.transpose(0, 1))
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasSgemm( handle, opa, opb, m, n, k, &alpha, a, lda, b, ldb, &beta, c, ldc)`
